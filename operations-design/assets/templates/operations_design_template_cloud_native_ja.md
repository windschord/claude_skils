# 運用設計書（クラウドネイティブ/サーバレス/Kubernetes対応）

## ドキュメント情報

| 項目 | 内容 |
|------|------|
| ドキュメント名 | [サービス名] 運用設計書 |
| インフラパターン | **クラウドネイティブ（サーバレス/Kubernetes）** |
| バージョン | [バージョン番号] |
| 作成日 | [YYYY-MM-DD] |
| 最終更新日 | [YYYY-MM-DD] |
| 作成者 | [作成者名] |
| 承認者 | [承認者名] |
| ステータス | [Draft / Review / Approved] |

**このテンプレートの適用対象**:
- サーバレスアーキテクチャ（Lambda, Cloud Functions, Cloud Run等）
- Kubernetes環境（EKS, GKE, AKS, 自前K8s等）
- マネージドサービス中心の構成
- コンテナベースのアプリケーション

## 改訂履歴

| バージョン | 日付 | 変更内容 | 変更者 |
|------------|------|----------|--------|
| 0.1 | YYYY-MM-DD | 初版作成 | [名前] |

---

## 📘 テンプレート構成について

このテンプレートは、大規模な運用設計書を管理しやすくするため、以下の5つのモジュールに分割されています。各モジュールは独立したファイルとして提供され、必要に応じて参照・カスタマイズが可能です。

### モジュール一覧

1. **[基盤設計](./modules/01_foundation.md)** - 概要、サービス概要、運用方針、体制、スケジュール
2. **[日常運用](./modules/02_daily_operations.md)** - 定常運用作業、監視・通知
3. **[変更・リリース管理](./modules/03_change_management.md)** - インシデント管理、変更管理、リリース管理、バックアップ
4. **[セキュリティ運用](./modules/04_security.md)** - セキュリティ運用、アクセス管理、脆弱性管理、DevSecOps
5. **[高度な運用手法](./modules/05_advanced_operations.md)** - キャパシティ管理、コスト管理とFinOps、Chaos Engineering、継続的改善

---

## 🎯 使い方ガイド

### 1. 初めて使用する場合

各モジュールファイルを順番に確認し、プロジェクトに必要なセクションを選択してください。

**必須モジュール**（すべてのプロジェクトで推奨）:
- ✅ 基盤設計（01_foundation.md）
- ✅ 日常運用（02_daily_operations.md）
- ✅ 変更・リリース管理（03_change_management.md）

**推奨モジュール**（セキュリティ要件がある場合）:
- ✅ セキュリティ運用（04_security.md）

**オプションモジュール**（高可用性・高度な運用が必要な場合）:
- ⭐ 高度な運用手法（05_advanced_operations.md）
  - 特にChaos Engineeringは、99.99%以上のSLA要件がある場合のみ適用を検討

### 2. 各モジュールの概要

#### 📋 [モジュール1: 基盤設計](./modules/01_foundation.md)

**含まれるセクション**:
- セクション1: 概要（目的、対象範囲、前提条件、クラウドネイティブ特有の考慮事項）
- セクション2: サービス概要（目的、機能、システム構成）
- セクション3: 運用方針と目標（SLO、SLI、SLA、エラーバジェット）
- セクション4: 運用体制（組織体制、RACI、運用時間帯）
- セクション5: 運用スケジュール（定期運用、メンテナンスウィンドウ）

**重要なポイント**:
- **クラウドネイティブ特有の考慮事項**を詳細に記載
  - 責任共有モデル
  - GitOps運用（ArgoCD/Flux）
  - サーバレス制限
  - Kubernetes運用課題
  - AWSタグ戦略
- **ユーザー中心のSLO設計**原則を採用

#### 🔄 [モジュール2: 日常運用](./modules/02_daily_operations.md)

**含まれるセクション**:
- セクション6: 定常運用作業（日次、週次、月次作業）
- セクション7: 監視・通知（監視方針、監視項目、ログ管理、アラート通知）

**重要なポイント**:
- **ユーザー体験起点の監視**設計
  - 優先度1: ユーザー体験監視（外形監視）
  - 優先度2: アプリケーション監視
  - 優先度3: インフラ監視
- **クラウドネイティブ固有の監視項目**
  - Lambda/Fargate監視
  - Kubernetes監視（Pod、Node、HPA）
  - AWSマネージドサービス監視（RDS、DynamoDB、SQS等）
  - コンテナイメージ・レジストリ監視
  - 分散トレーシング

#### 🛠 [モジュール3: 変更・リリース管理](./modules/03_change_management.md)

**含まれるセクション**:
- セクション8: インシデント管理（定義、対応フロー、エスカレーション）
- セクション9: 変更管理（方針、分類、フロー、ロールバック）
- セクション10: リリース管理（方針、スケジュール、デプロイメント戦略）
- セクション11: バックアップ・リカバリ（方針、設計、DR）

**重要なポイント**:
- インシデント優先度に応じた対応目標時間
- 変更分類（標準/通常/緊急/重要）と承認プロセス
- デプロイメント戦略（Blue-Green、Rolling、Canary）
- RPO/RTOの明確な定義

#### 🔒 [モジュール4: セキュリティ運用](./modules/04_security.md)

**含まれるセクション**:
- セクション12: セキュリティ運用（方針、アクセス管理、脆弱性管理、DevSecOps）

**重要なポイント**:
- **DevSecOps: CI/CDパイプラインのセキュリティ**（最も詳細なセクション）
  - SAST（静的解析）
  - 依存関係スキャン（SCA）
  - コンテナイメージスキャン
  - DAST（動的解析）
  - シークレットスキャン
  - IaCセキュリティスキャン
  - ランタイムセキュリティ保護
- セキュリティメトリクスとダッシュボード
- セキュリティチャンピオン制度
- DevSecOps成熟度評価

#### ⚡ [モジュール5: 高度な運用手法](./modules/05_advanced_operations.md)

**含まれるセクション**:
- セクション13: キャパシティ管理（監視、計画、スケーリング戦略）
- セクション14: コスト管理とFinOps（FinOps原則、コスト構造、最適化、タグ戦略、RI/SP戦略）
- セクション15: レジリエンステストとChaos Engineering（オプション）
- セクション16: 問題管理（方針、プロセス、既知のエラー管理）
- セクション16: ナレッジ管理（方針、ドキュメント体系）
- セクション17: 継続的改善（方針、プロセス、メトリクス）
- セクション18: 運用ツール（ツール一覧、統合）
- セクション19: 付録（用語集、参照ドキュメント、連絡先、承認）

**重要なポイント**:
- **FinOps（クラウド財務管理）**の詳細ガイド
  - チーム間のコラボレーション
  - データドリブンな意思決定
  - ビジネス価値の最大化
  - Savings Plans/RI戦略
  - タグ戦略とコスト配分
- **Chaos Engineering**（高可用性システム向け）
  - 適用判断基準
  - 段階的導入アプローチ
  - 実験カタログ
  - GameDay（障害演習）

---

## 📝 テンプレートのカスタマイズ方法

### ステップ1: プロジェクト規模の確認

| プロジェクト規模 | 推奨モジュール | 備考 |
|-----------------|--------------|------|
| **小規模**（開発環境、実験的プロジェクト） | モジュール1, 2, 3 | 基本的な運用のみ |
| **中規模**（本番運用、標準的なSLA） | モジュール1, 2, 3, 4 | セキュリティ運用を追加 |
| **大規模**（高可用性要件、99.99%以上のSLA） | モジュール1, 2, 3, 4, 5（一部） | Chaos Engineering等を選択的に適用 |

### ステップ2: 各モジュールのカスタマイズ

1. 各モジュールファイルを開く
2. `[項目]` や `[内容]` などのプレースホルダーをプロジェクト固有の情報に置き換える
3. 不要なセクションは削除または「N/A」と記載
4. プロジェクト特有のセクションを追加

### ステップ3: 運用設計書の統合（オプション）

必要に応じて、すべてのモジュールを1つのドキュメントに統合することも可能です。ただし、ファイルサイズが大きくなるため、以下の点に注意してください：

- 大きなファイルは編集・レビューが困難になる
- モジュール形式のまま管理することを推奨
- 必要に応じて、特定のモジュールのみを共有・レビュー

---

## 🔍 クイックリファレンス

### 重要な設計原則

**ユーザー中心の設計**:
- SLO設計: 「測りやすい指標」ではなく「ユーザーが快適に使える範囲」を基準
- 監視設計: 「ユーザー体験起点」で優先順位を付ける
  1. 外形監視（ユーザー視点）
  2. アプリケーション監視（原因特定）
  3. インフラ監視（裏付け）

**クラウドネイティブの考慮事項**:
- 責任共有モデルの理解
- GitOps運用（ArgoCD/Flux）
- サーバレス制限（Lambda同時実行数、タイムアウト）
- Kubernetes運用課題（Pod管理、ノードメンテナンス）
- タグ戦略（コスト配分の基盤）

**DevSecOps**:
- Shift Left Security（開発の早期段階でセキュリティを組み込む）
- CI/CDパイプラインへのセキュリティゲート統合
  - SAST → 依存関係スキャン → コンテナスキャン → DAST

**FinOps**:
- コスト削減ではなくビジネス価値の最大化
- エンジニアリング・財務・ビジネスチームの協力
- Unit Economics（コスト/ユーザー、コスト/トランザクション）の追跡

### よくある質問（FAQ）

**Q1: すべてのセクションを埋める必要がありますか？**
A: いいえ。プロジェクトの規模や要件に応じて、必要なセクションのみを使用してください。小規模プロジェクトではモジュール1-3で十分です。

**Q2: Chaos Engineering（セクション15）は必須ですか？**
A: いいえ。99.99%以上のSLA要件があり、ダウンタイムが重大な損失をもたらす場合にのみ適用を検討してください。多くのプロジェクトでは不要です。

**Q3: モジュールを統合して1つのファイルにできますか？**
A: 可能ですが、ファイルサイズが大きくなり編集が困難になります。モジュール形式のまま管理することを推奨します。

**Q4: クラウドプロバイダーがAWS以外の場合は？**
A: GCP、Azureでも同様の考え方が適用できます。サービス名やツール名を置き換えて使用してください。

**Q5: オンプレミス環境には使えますか？**
A: このテンプレートはクラウドネイティブ向けです。オンプレミス向けには別のテンプレート（operations_design_template_onpremise_ja.md）を使用してください。

---

## 📚 参考リソース

### 各モジュールの詳細

詳細な内容は各モジュールファイルを参照してください：

- [01_foundation.md](./modules/01_foundation.md) - 基盤設計（515行）
- [02_daily_operations.md](./modules/02_daily_operations.md) - 日常運用（255行）
- [03_change_management.md](./modules/03_change_management.md) - 変更・リリース管理（285行）
- [04_security.md](./modules/04_security.md) - セキュリティ運用（298行）
- [05_advanced_operations.md](./modules/05_advanced_operations.md) - 高度な運用手法（717行）

**合計**: 約2,070行（元のファイルサイズの約93%）

### 関連ドキュメント

- EARS記法ガイド: [../../references/ears_notation_ja.md](../../references/ears_notation_ja.md)
- 実装例: [../../references/examples_ja.md](../../references/examples_ja.md)

---

## ✅ チェックリスト

運用設計書を作成する際のチェックリスト：

### 基盤設計（モジュール1）
- [ ] プロジェクトの目的と対象範囲を明確に定義
- [ ] クラウドネイティブ特有の考慮事項を確認
- [ ] ユーザー中心のSLO/SLI/SLAを設計
- [ ] 運用体制（RACI）を明確化
- [ ] 運用スケジュールを計画

### 日常運用（モジュール2）
- [ ] 定常運用作業を定義（日次、週次、月次）
- [ ] ユーザー体験起点の監視項目を設定
- [ ] クラウドネイティブ固有の監視項目を追加
- [ ] アラート通知ルートを設計

### 変更・リリース管理（モジュール3）
- [ ] インシデント対応フローを確立
- [ ] 変更管理プロセスを定義
- [ ] デプロイメント戦略を選択
- [ ] バックアップ・リカバリ計画を策定

### セキュリティ運用（モジュール4）
- [ ] セキュリティ運用方針を定義
- [ ] アクセス管理ルールを確立
- [ ] DevSecOpsパイプラインを設計
- [ ] セキュリティメトリクスを定義

### 高度な運用手法（モジュール5）
- [ ] キャパシティ管理計画を策定
- [ ] FinOpsの実践方法を定義
- [ ] （該当する場合）Chaos Engineering導入を検討
- [ ] 継続的改善プロセスを確立

---

## 📞 サポート

このテンプレートに関する質問や改善提案は、プロジェクトのメンテナーにお問い合わせください。

---

**作成日**: 2025-01-XX
**最終更新日**: 2025-01-XX
**バージョン**: 2.0（モジュール分割版）
