# SDDワークフローガイド

## 概要

このガイドでは、SDD（ソフトウェア設計ドキュメント）の作成から完了までのワークフローを説明します。

## スキル構成

```
sdd-documentation（オーケストレーター）
    │
    ├── requirements-defining（要件定義）
    │       └── docs/requirements.md
    │
    ├── software-designing（設計）
    │       └── docs/design.md
    │
    └── task-planning（タスク計画）
            └── docs/tasks.md
```

## ワークフロー詳細

### フェーズ1: 初期化

**目的**: プロジェクトのドキュメント基盤を構築

**手順**:
1. docsディレクトリを作成
2. 3つのテンプレートファイルを配置
3. プロジェクト情報を確認

**成果物**:
```
docs/
├── requirements.md（テンプレート）
├── design.md（テンプレート）
└── tasks.md（テンプレート）
```

### フェーズ2: 要件定義

**使用スキル**: `requirements-defining`

**目的**: 何を作るかを明確に定義

**手順**:
1. プロジェクトの目的・対象ユーザーを確認
2. ユーザーストーリーを作成
3. EARS記法で受入基準を定義
4. 非機能要件を追加
5. ユーザー確認・承認

**チェックポイント**:
- [ ] すべての要件がEARS記法に従っている
- [ ] 要件IDが一意である
- [ ] 各要件がテスト可能である
- [ ] ユーザーの承認を得た

### フェーズ3: 設計

**使用スキル**: `software-designing`

**目的**: どのように作るかを文書化

**手順**:
1. requirements.mdを読み込む
2. 不明点をユーザーに確認
3. アーキテクチャを設計
4. コンポーネントを定義
5. API・データベースを設計
6. 要件との整合性を確認
7. ユーザー確認・承認

**チェックポイント**:
- [ ] すべての要件に対応する設計要素がある
- [ ] 技術的決定事項と根拠が記載されている
- [ ] 情報の明確性チェックが完了している
- [ ] ユーザーの承認を得た

### フェーズ4: タスク計画

**使用スキル**: `task-planning`

**目的**: どのように実装するかを計画

**手順**:
1. requirements.md、design.mdを読み込む
2. 不明点をユーザーに確認
3. フェーズに分けてタスクを分解
4. 各タスクにTDD手順を追加
5. 依存関係を整理
6. ユーザー確認・承認

**チェックポイント**:
- [ ] タスクが適切な粒度である（20-40分）
- [ ] 各タスクに受入基準がある
- [ ] 推測に基づく実装指示がない
- [ ] ユーザーの承認を得た

### フェーズ5: 逆順レビュー

**使用スキル**: `sdd-documentation`または`task-planning`

**目的**: 3ドキュメント間の整合性を確認

**手順**:
```
tasks.md
   ↓ タスクが参照するコンポーネント/APIは設計に定義されているか
design.md
   ↓ すべての要件に対応する設計要素があるか
requirements.md
```

**チェック項目**:

| チェック | 内容 |
|---------|------|
| タスク → 設計 | コンポーネント、API、データモデル、技術スタックの整合性 |
| 設計 → 要件 | 機能カバレッジ、非機能要件対応、過剰設計チェック |
| 過不足 | 要件にない機能がないか、実装漏れがないか |

**不整合発見時**:
1. 不整合をリストアップ
2. ユーザーに確認
3. 確認後にドキュメントを修正

### フェーズ6: 完了

**成果物**:
```
docs/
├── requirements.md（完成版）
├── design.md（完成版）
└── tasks.md（完成版）
```

**最終チェック**:
- [ ] 3ドキュメントすべてが完成している
- [ ] 逆順レビューが完了している
- [ ] 不整合がすべて解消されている
- [ ] ユーザーの最終承認を得た

## 使い分けガイド

### 一括フロー（推奨）

**使用スキル**: `sdd-documentation`

**適した場面**:
- 新規プロジェクトの立ち上げ
- ドキュメント一式を最初から作成
- 全体の整合性を重視

### 個別フロー

**使用スキル**: 各サブスキル

**適した場面**:
- 既存ドキュメントの一部を修正
- 特定のフェーズのみ作業
- 段階的にドキュメントを作成

| 作業内容 | 使用スキル |
|---------|-----------|
| 要件の追加・修正 | `requirements-defining` |
| 設計の更新 | `software-designing` |
| タスクの追加・更新 | `task-planning` |
| 整合性チェック | `sdd-documentation` |

## トラブルシューティング

### 不整合が多い場合

1. まず要件定義（requirements.md）を見直す
2. 要件が明確になったら設計を修正
3. 最後にタスクを更新

### 情報が不足している場合

1. 不明点をリストアップ
2. ユーザーに確認
3. 確認済み情報のみでドキュメント作成
4. 推測は絶対に行わない

### スコープが大きすぎる場合

1. 優先度の高い要件を特定
2. MVP（最小限の製品）スコープを定義
3. フェーズ分けして段階的に実装

## ベストプラクティス

1. **ユーザー確認を怠らない**: 各フェーズ完了時に必ず確認
2. **推測しない**: 不明点は必ず質問
3. **整合性を維持**: 変更時は他ドキュメントへの影響を確認
4. **具体的に記述**: 曖昧な表現を避け、測定可能な値を使用
5. **TDDを遵守**: タスクには必ずテスト手順を含める
