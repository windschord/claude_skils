# Task Executing

docs/tasks/に記載されたタスクを自動的に実行するClaude Codeサブエージェントです。

## 概要

Task Executingは、SDDワークフローの実装フェーズを担当するサブエージェントです。プロジェクトのdocs/tasks/ファイルからタスクを読み取り、自動的に実装を行います。並列実行可能なタスクは並列で処理し、各タスク完了後に適切なコミットを作成します。

## インストール

このエージェントは `claude_skils` プラグインの一部として提供されます。

### GitHub からのインストール

```bash
/plugin marketplace add https://github.com/windschord/claude_skils.git
```

### ローカル開発・テスト

```bash
/plugin marketplace add /path/to/claude_skils
```

## 主な機能

- docs/tasks/からのタスク自動読み取り
- サブエージェントを使用した自動実装
- 並列実行可能なタスクの並列処理
- タスクごとの自動コミット作成
- タスク完了前チェックリスト（カテゴリ別）
- 逆順レビュー（実装 → タスク → 設計 → 要件）
- 絵文字を使用しないクリーンなメッセージ

## ファイル構成

```
claude_skils/
├── .claude-plugin/
│   └── marketplace.json     # プラグインマニフェスト
├── agents/
│   └── task-executing.md    # サブエージェント定義
└── task-executing/
    ├── references/
    │   ├── execution_guide_ja.md
    │   └── commit_templates_ja.md
    └── README.md
```

## 使用方法

### サブエージェントとして使用

タスク実行が必要と判断された場合、Claudeは自動的にこのエージェントに委譲します。

明示的に呼び出す場合:

```
task-executingエージェントを使ってタスクを実行してください
```

または

```
docs/tasks/のタスクを進めてください
```

### 複数タスクの実行

```
docs/tasks/のすべてのTODOタスクを実行してください
```

## タスクの実行フロー

```text
1. docs/tasks/index.md読み取り
   ↓
2. 実行可能なタスクを特定（TODO状態、依存関係解消済み）
   ↓
3. ★ エージェントチーム判定 ★
   │
   ├─ 並列可能タスク3つ以上 → エージェントチーム並列実行（後述）
   │
   └─ それ以外 → 単一セッション順次実行（以下のステップ4-11）
   ↓
4. 個別タスクファイルを読み込み
   ↓
5. ステータスをIN_PROGRESSに更新・コミット
   ↓
6. 実装
   ↓
7. 受入基準の確認
   ↓
8. タスク完了前チェックリスト確認（該当カテゴリを提示）
   ↓
9. コミット作成（テンプレート使用）
   ↓
10. ステータスをDONEに更新・コミット
   ↓
11. 逆順レビュー
   ↓
12. 次のタスクへ（または完了）
```

### エージェントチーム判定基準（必須評価）

タスクを特定した後、以下を**必ず評価**する:

1. 並列実行可能なタスクが3つ以上ある
2. 各タスクが異なるファイルセットを対象
3. タスク間に依存関係がない（同一グループ内）

**すべてYES → エージェントチームを作成**して「エージェントチームによる並列実行」フローに進む。

## タスク完了前チェックリスト

タスクをDONEとしてマークする前に、タスク内容を分析して該当するカテゴリのチェックリストを提示します。

### 対象カテゴリ

| カテゴリ | 対象 |
| --------- | ------ |
| UI変更 | フロントエンドコンポーネント、CSS/スタイル変更、レイアウト |
| 外部システム連携 | Docker/コンテナ、Git操作、外部API連携 |
| データ操作 | データベース操作、ファイル読み書き、リスト/配列処理 |
| コンポーネント再利用 | 既存コンポーネントの別画面利用、リファクタリング |
| リモートリポジトリ | プッシュを伴う実装、PR作成/更新 |

## コミット管理

### 実装コミット

```text
[タスクID] タスクタイトル

## 実装内容
- 実装した機能の説明
- 主な変更点

## 受入基準の達成状況
- [x] 基準1
- [x] 基準2

## 関連ドキュメント
- docs/tasks/[phase]/TASK-XXX.md: タスク詳細
- docs/design/components/[name].md: 関連コンポーネント
- docs/requirements/stories/US-XXX.md: 関連要件

## テスト
- テスト実行結果
```

## 逆順レビュー

実装完了後、以下の順序で整合性を確認します:

```text
実装 → docs/tasks/ → docs/design/ → docs/requirements/
```

### チェック項目

1. **実装 → タスク**: 受入基準達成、ファイル一致、テスト通過
2. **タスク → 設計**: コンポーネント/API/データモデル対応
3. **設計 → 要件**: 要件カバレッジ、過剰実装チェック

## 並列実行（サブエージェント方式 - タスク2個以下の場合）

並列実行可能なタスクが1-2個の場合は、サブエージェント（Task tool）で並列実行する:

```
以下のタスクを並列実行します:

- Task 1.1: ユーザー認証APIエンドポイントの実装
- Task 1.2: データモデルの定義

実行を開始してよろしいですか？
```

**注意**: 3つ以上の場合はエージェントチームを使用すること（上記「エージェントチームによる並列実行」セクション参照）。

## 制約事項

以下の場合は自動実行を行わず、ユーザーに確認を求めます:

- タスクの説明が曖昧で、実装方法が複数考えられる場合
- 本番環境への直接的な変更など、リスクの高い操作
- 技術選択やアーキテクチャの決定が必要な場合

## エージェントチームによる並列実行（条件を満たす場合は積極的に使用）

### 概要

依存関係のない複数タスクが3つ以上ある場合、エージェントチームを作成して並列実行する。チームリーダーがタスクを分配し、各チームメンバーが独立して実装を進める。

**重要**: エージェントチーム判定で条件を満たした場合、このフローを使用すること。サブエージェント（Task tool）ではなくエージェントチームを優先する理由は、チームメンバー間で発見の共有・問題報告が直接できるため。

### チーム実行時のフロー

```text
1. 並列実行可能なタスクグループを特定
   ↓
2. エージェントチームを作成（デリゲートモード）
   ↓
3. 各チームメンバーにタスクを割り当て
   ↓
4. チームメンバーが独立して実装
   ↓
5. リーダーが全メンバーの完了を待機
   ↓
6. リーダーがdocs/tasks/index.mdとTodoWriteを一括更新
   ↓
7. 次の依存グループへ → 全完了後に逆順レビュー → クリーンアップ
```

### チームメンバーの役割

- 割り当てられたタスクファイルのTDD手順に従って実装
- 自分の担当ファイルのみ編集（ファイル競合回避）
- docs/tasks/index.mdとTodoWriteの更新はリーダーに委任
- 完了後にステータスをDONEに更新、コミット作成、リーダーへ報告

**チーム作成プロンプト例・使い分けガイド**: `sdd-documentation/references/agent_teams_guide_ja.md`

## TodoWrite同期

### 概要

タスクの進捗をClaude CodeのTodoWriteと同期し、ユーザーにリアルタイムで進捗を表示します。

### 同期ルール

| タイミング | SDD操作 | TodoWrite操作 |
|-----------|---------|---------------|
| タスク開始 | ステータス: IN_PROGRESS | status: in_progress |
| タスク完了 | ステータス: DONE | status: completed |
| タスクブロック | ステータス: BLOCKED | contentに[BLOCKED]付記 |

### 注意

- SDDのdocs/tasks/が正（Source of Truth）
- TodoWriteは進捗可視化が主目的
- タスクIDは`[TASK-XXX]`形式でTodoWriteのcontentに含める

## SDDワークフローとの統合

このプラグインは、sdd-documentationスキルと連携して使用することを推奨します:

```text
requirements-defining → software-designing → task-planning → task-executing
   (requirements/)         (design/)           (tasks/)         (実装)
```

## ライセンス

MITライセンス
